<html>
<head>
<title>CHANGES</title>
</head>
<body BGCOLOR=white>
<h1>CHANGES in 0.91a Release</h1>
<h2>Bugs Fixed</h2>
<p>
For bug fixes and current open bugs see
<a href=http://www.cs.princeton.edu/zephyr/ASDL/asdlGen-bugs.html>
<tt>http://www.cs.princeton.edu/zephyr/ASDL/asdlGen-bugs.html</tt></a>
<h2>New Features</h2>
<ul>
<li>Added generic pickle pretty printer.
Given an an ASDL defintion such as
<pre>
module T {
  t = ....
}
</pre>
Calling
<pre>
  asdlGen --typ ./T.asdl
</pre>
will produces a type environment called <tt>T.asdl.typ</tt>
If we have a pickle <tt>t.pkl</tt> generated by the picklers from that 
same type environment, that contains a single type <tt>T.t</tt>
<pre>
 asdlGen --pp_pkl T.asdl.typ T.t
</pre>
will produce and HTML dump of the pickle. 
<pre>
 asdlGen --pp_pkl --text T.asdl.typ T.t
</pre>
will produce a plain text dump of the pickle.
<li>Added options to control inclusion of the base environment. i.e.
  <ul> 
  <li>--base_include (C,C++)
  <li>--base_import  (Java)
  <li>--base_signature --base_structure (ML)
  </ul>
<li>Added views to allow turning of several knobs. See
<a href=src/doc/views.html><tt>src/doc/views.html</tt></a>
<pre>
  asdlGen --lang --view view_name
</pre>
<li>Allow C,C++, and Java to choose enum value via <tt>enum_value</tt> 
 property
<pre>
view C {
	Slp.Id <= enum_value: 1
}
</pre>
<li>Added properties to add user code verbatim in  code. Not
supported in all languages yet.
  <ul>
  <li> interface_prologue
  <li> interface_epilogue
  <li> implementation_prologue
  <li> implementation_epilogue
  </ul>
<pre>
view C {

  module Slp <= interface_prologue
%%
#include "mytypes.h"
%%

}
</pre>

<li>Added support for user types in C and ML via
<pre>
view SML {
-- make exp a mutable value
  Slp.exp <= natural_type_con :ref
  Slp.exp <= unwrapper        :ref
  Slp.exp <= wrapper          :!
}
</pre>
<pre>
view C {
  Slp.pos <= natural_type     :int
  Slp.pos <= unwrapper        :pos2int
  Slp.pos <= wrapper          :int2pos
}
</pre>
<dl>
<dt><tt>natural_type</tt>
<dd>A qualified identifier that describes the type to use in place of the
default ASDL type. 

<dt><tt>natural_type_con</tt>
<dd>A qualified identifier that names a type constructor that 
describes the type to use in place of the ASDL type.

<dt><tt>wrapper</tt>
<dd>A qualified identifier that names a function that converts from the
default ASDL type to a special type used in its place.

<dt><tt>unwrapper</tt>
<dd>A qualified identifier that names a function that converts from a
special in-core type to the default ASDL type.
</dl>
<li>Added support for user picklers 
<pre>
view C {
    Slp.exp <= user_reader : my_reader_id
    Slp.exp <= user_writer : my_writer_id
}
</pre>
<li>Added user_attribute support for C
<pre>
view C {
  Slp.exp <= user_attribute : my_user_type_id
}
</pre>
Adds an extra field to the <tt>exp</tt> called <tt>client_data</tt> of 
type <tt>my_user_type_id</tt>. This field is completely ignored by the
picklers and constructor functions. A user defined wrapper functions can be
used to initialize it when pickling or unpickling a value. See the
discussion or <tt>wrapper</tt> and <tt>unwrapper</tt> above.

<li>Added --mono_types option. The mono_type option controls whether code
generated will create a new type for every list or option type or use one
uniform type.Rather
than creating a new list type for each different type of list. See <a
href=src/c/cii_base.h><tt>src/c/cii_base.h</tt></a> for an example of the
required functions to provided this interface. By default this flag is set
to true.
For details compare the output of
<pre>
  asdlGen --c --mono_types false src/asdl/slp3.asdl
</pre>
and 
<pre>
  asdlGen --c --mono_types true src/asdl/slp3.asdl
</pre>
<li> Untested code for libcii support
<a href=src/c/cii_base.h><tt>src/c/cii_base.h</tt></a>
<a href=src/c/cii_base.c><tt>src/c/cii_base.c</tt></a>
</body>
</html>






